---
title: RSAåŠ å¯†ç®—æ³•
type: docs
---

![des](../../../railroad-horizon.png)
è‡ªå¤ä»¥æ¥ï¼Œäººç±»å°±è¯•å›¾ä¿æŠ¤ä¿¡æ¯çš„å®‰å…¨â€”â€”ä»å¤åŸƒåŠçš„è±¡å½¢æ–‡å­—ï¼Œåˆ°å‡¯æ’’çš„ç®€å•ç§»ä½å¯†ç ï¼Œå†åˆ°äºŒæˆ˜ä¸­çš„æ©å°¼æ ¼ç æœºï¼Œæ¯ä¸€æ¬¡å¯†ç çš„åˆ›æ–°éƒ½å½±å“ç€æˆ˜äº‰ã€æ”¿æ²»ä¹ƒè‡³æ–‡æ˜çš„å‘å±•  
è¿›å…¥ä¿¡æ¯æ—¶ä»£,ç”µå­é€šä¿¡æ— å¤„ä¸åœ¨,æˆ‘ä»¬éœ€è¦ä¸€ç§å…¨æ–°çš„æ–¹æ³•æ¥ä¿è¯ä¿¡æ¯åœ¨å…¬å¼€ç½‘ç»œä¸­ä»ç„¶å®‰å…¨ä¼ è¾“.1977å¹´,ä¸‰ä½æ•°å­¦å®¶â€”â€”Ron Rivestã€Adi Shamir å’Œ Leonard Adlemanâ€”â€”æå‡ºäº† RSAç®—æ³•,å®ƒä¸ä»…æ˜¯éå¯¹ç§°åŠ å¯†çš„å¥ åŸºçŸ³,ä¹Ÿæ ‡å¿—ç€å¯†ç å­¦ä»ç§˜å¯†ä¼ è¾“èµ°å‘å…¬é’¥æ—¶ä»£çš„å†å²æ€§é£è·ƒ     
ä»Šå¤©ï¼Œæˆ‘ä»¬å°†ä»æ•°å­¦çš„è§†è§’ï¼Œè¿½æº¯ RSA çš„è¯ç”Ÿé€»è¾‘ï¼šè´¨æ•°ã€æ¬§æ‹‰å‡½æ•°ã€å…¬é’¥ä¸ç§é’¥ã€‚ä½ å°†çœ‹åˆ°ï¼Œæ­£æ˜¯è¿™äº›å¤è€è€Œç®€å•çš„æ•°å­¦æ¦‚å¿µï¼Œæ”¯æ’‘èµ·ç°ä»£æ•°å­—ä¸–ç•Œçš„å®‰å…¨ä¸ä¿¡ä»»

# ç®—æ³•æ¨ç†
æˆ‘å®ç°çš„æ˜¯çº¯RSAä¸åŒ…å«å¯†é’¥å¡«å……ï¼Œå¯†é’¥å¡«å……åœ¨ä»¥ååšå¯†ç å­¦åº“å†å®Œæ•´å®ç°
## ç®—æ³•æ€æƒ³
1. å¤§è´¨æ•°çš„ä¹˜ç§¯éš¾ä»¥åˆ†è§£(è´¨å› æ•°åˆ†è§£å›°éš¾)
2. æ¨¡æŒ‡æ•°è¿ç®—çš„é€†è¿ç®—å…³ç³»

## ç®—æ³•æ­¥éª¤
1. é€‰æ‹©ä¸¤ä¸ªå¤§è´¨æ•° ğ‘,q
    - ç”¨æ¥ç”Ÿæˆå¯†é’¥
2. è®¡ç®— n = p * q
    - nä½œä¸ºæ¨¡æ•°
3. è®¡ç®—æ¬§æ‹‰å‡½æ•° Ï•(n)=(pâˆ’1)(qâˆ’1)
    > [!NOTE]
    > å°äº n çš„æ­£æ•´æ•°ä¸­,æœ‰å¤šå°‘ä¸ªå’Œ n äº’è´¨(gcd = 1)   
    > Ï•(n)=#{kâˆˆ[1,nâˆ’1]âˆ£gcd(k,n)=1}    
    > å„ä½å…·ä½“æƒ³å­¦ä¹ çš„è¯å¯ä»¥é—®AI
4. é€‰æ‹©å…¬é’¥æŒ‡æ•°`(e)`
    - 1 < e < Ï•(n),å¹¶ä¸”gcd(e,Ï•(n)) = 1
    - å¸¸ç”¨çš„æ˜¯65537
5. è®¡ç®—ç§é’¥`d`
    - ä½¿å¾— ğ‘‘ Ã— ğ‘’ â‰¡ 1 ( mod ğœ‘(ğ‘›))
    - ä¹Ÿå°±æ˜¯ ğ‘‘ = ğ‘’^(âˆ’1) mod ğœ‘(ğ‘›)
6. åŠ å¯†/è§£å¯†
    - åŠ å¯† => c = m^e mod n
    - è§£å¯† => m = c^d mod n

# ç®€ç•¥ä»£ç å®ç°
```go
package main

import (
    "crypto/rand"
    "fmt"
    "math/big"
)

// ç®€å•ç”ŸæˆRSAå¯†é’¥
func generateRSAKey() (n, e, d *big.Int) {
    // é€‰æ‹©ä¸¤ä¸ªè´¨æ•°
    p, _ := rand.Prime(rand.Reader, 64) // ç”¨å°ä½æ•°æ–¹ä¾¿æ¼”ç¤º
    q, _ := rand.Prime(rand.Reader, 64)
    n = new(big.Int).Mul(p, q)

    // è®¡ç®—Ï†(n)
    p1 := new(big.Int).Sub(p, big.NewInt(1))
    q1 := new(big.Int).Sub(q, big.NewInt(1))
    phi := new(big.Int).Mul(p1, q1)

    // é€‰æ‹©å…¬é’¥ e
    e = big.NewInt(65537)

    // è®¡ç®—ç§é’¥ d
    d = new(big.Int).ModInverse(e, phi)

    return
}

func encrypt(m, e, n *big.Int) *big.Int {
    c := new(big.Int).Exp(m, e, n)
    return c
}

func decrypt(c, d, n *big.Int) *big.Int {
    m := new(big.Int).Exp(c, d, n)
    return m
}

func main() {
    n, e, d := generateRSAKey()
    fmt.Println("n =", n)
    fmt.Println("e =", e)
    fmt.Println("d =", d)

    // æµ‹è¯•åŠ è§£å¯†
    message := big.NewInt(42)
    cipher := encrypt(message, e, n)
    fmt.Println("å¯†æ–‡:", cipher)
    plain := decrypt(cipher, d, n)
    fmt.Println("è§£å¯†å:", plain)
}
```
